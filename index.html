<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>优办开放平台开发者文档 by uban360</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">优办开放平台开发者文档</h1>
        <p class="header"></p>



        <ul>
          <li><a class="buttons github" href="https://github.com/uban360">GitHub Profile</a></li>
        </ul>

      </header>
      <section>
        <h1>
<a id="一----开始前必读" class="anchor" href="#%E4%B8%80----%E5%BC%80%E5%A7%8B%E5%89%8D%E5%BF%85%E8%AF%BB" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>一，    开始前必读</h1>

<h2>
<a id="一张图看懂开放平台" class="anchor" href="#%E4%B8%80%E5%BC%A0%E5%9B%BE%E7%9C%8B%E6%87%82%E5%BC%80%E6%94%BE%E5%B9%B3%E5%8F%B0" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>一张图看懂开放平台</h2>

<p><img src="http://7xnmmr.com2.z0.glb.qiniucdn.com/openapipink.png" alt="开放平台时序图"></p>

<h2>
<a id="1-更新日志" class="anchor" href="#1-%E6%9B%B4%E6%96%B0%E6%97%A5%E5%BF%97" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>1， 更新日志</h2>

<ul>
<li>2016年4月15日  开放平台上线，提供获取当前登录用户信息接口，和管理员后台</li>
<li>2016年4月20日 提供接口权限验证，不同接口享有不同权限</li>
</ul>

<h2>
<a id="2-开发者规范" class="anchor" href="#2-%E5%BC%80%E5%8F%91%E8%80%85%E8%A7%84%E8%8C%83" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2， 开发者规范</h2>

<p>开发者进行开放平台开发时，除了要满足接口的规范限制和接口调用频率限制外，还需特别注意用户敏感信息的使用规范。
涉及用户数据时：</p>

<ul>
<li>您收集用户的数据后，必须采取必要的保护措施，防止用户数据被盗、泄漏等。</li>
<li>如果我们认为您收集、使用用户数据的方式，可能损害用户体验，我们有权要求您删除相关数据并不得再以该方式收集、使用用户数据。</li>
<li>一旦您停止使用本服务，或 基于任何原因终止您使用本服务，您必须立即删除全部因使用本服务而获得的数据（包括各种备份）， 且不得再以任何方式进行使用。</li>
</ul>

<h2>
<a id="3-开放平台接口权限说明" class="anchor" href="#3-%E5%BC%80%E6%94%BE%E5%B9%B3%E5%8F%B0%E6%8E%A5%E5%8F%A3%E6%9D%83%E9%99%90%E8%AF%B4%E6%98%8E" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>3， 开放平台接口权限说明</h2>

<p>不同类型的开放平台账号具有不同的接口权限，见下表</p>

<table>
<thead>
<tr>
<th>接口名称</th>
<th>未认证开放平台账号</th>
<th>认证开放平台账号</th>
</tr>
</thead>
<tbody>
<tr>
<td>获取accessToken</td>
<td>有</td>
<td>有</td>
</tr>
<tr>
<td>获取用户基本信息</td>
<td>无</td>
<td>有</td>
</tr>
<tr>
<td>获取部门列表</td>
<td>无</td>
<td>有</td>
</tr>
<tr>
<td>获取部门员工列表</td>
<td>无</td>
<td>有</td>
</tr>
<tr>
<td>获取部门员工详情</td>
<td>无</td>
<td>有</td>
</tr>
<tr>
<td>发送聊天消息</td>
<td>无</td>
<td>有</td>
</tr>
<tr>
<td>其他接口完善中</td>
<td>...</td>
<td>...</td>
</tr>
</tbody>
</table>

<h2>
<a id="4-开放平台接口调用频率说明" class="anchor" href="#4-%E5%BC%80%E6%94%BE%E5%B9%B3%E5%8F%B0%E6%8E%A5%E5%8F%A3%E8%B0%83%E7%94%A8%E9%A2%91%E7%8E%87%E8%AF%B4%E6%98%8E" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>4， 开放平台接口调用频率说明</h2>

<ul>
<li>开放平台的调用接口并不是无限制的。为了防止公众号的程序错误而引发 服务器负载异常，默认情况下，每个开发者应用调用接口都不能超过一定限制，当超过一定限制时，调用对应接口会收到如下错误返回码</li>
</ul>

<pre><code>
{"status":4006,"message":"接口调用频率超过限制"} 

</code></pre>

<ul>
<li>认证账号的调用量清零。针对认证的开发者账号，每月提供10次清零操作机会，可以针对同一接口，也可以针对不同接口清零。新注册账号接口调用频率见下表</li>
</ul>

<table>
<thead>
<tr>
<th>接口名称</th>
<th>每日限额</th>
</tr>
</thead>
<tbody>
<tr>
<td>获取accessToken</td>
<td>2000</td>
</tr>
<tr>
<td>获取用户基本信息</td>
<td>5000</td>
</tr>
<tr>
<td>获取部门列表</td>
<td>5000</td>
</tr>
<tr>
<td>获取部门员工列表</td>
<td>5000</td>
</tr>
<tr>
<td>获取部门员工详情</td>
<td>5000</td>
</tr>
<tr>
<td>发送聊天消息</td>
<td>5000</td>
</tr>
<tr>
<td>其他接口完善中</td>
<td>...</td>
</tr>
</tbody>
</table>

<h2>
<a id="5-开放平台接口返回说明" class="anchor" href="#5-%E5%BC%80%E6%94%BE%E5%B9%B3%E5%8F%B0%E6%8E%A5%E5%8F%A3%E8%BF%94%E5%9B%9E%E8%AF%B4%E6%98%8E" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>5， 开放平台接口返回说明</h2>

<p>应用每次调用接口时，可能获得正确或错误的返回码，开发者可以根据返回码信息调试接口，排查错误。见下表</p>

<table>
<thead>
<tr>
<th>返回码</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>调用成功</td>
</tr>
<tr>
<td>-1</td>
<td>开放平台系统错误</td>
</tr>
<tr>
<td>4000</td>
<td>用户登录token错误</td>
</tr>
<tr>
<td>4001</td>
<td>用户登录token和accessToken错误，重新获取</td>
</tr>
<tr>
<td>4002</td>
<td>accessToken错误</td>
</tr>
<tr>
<td>4003</td>
<td>AccessToken超时</td>
</tr>
<tr>
<td>4004</td>
<td>AccessToken刷新过于频繁，注意每天的接口调用次数</td>
</tr>
<tr>
<td>4005</td>
<td>accessToken错误，一般是系统原因，重新获取或者联系客服</td>
</tr>
<tr>
<td>4006</td>
<td>接口调用频率超过限制</td>
</tr>
<tr>
<td>4007</td>
<td>获取accessToken时appId或者appSecret错误</td>
</tr>
<tr>
<td>4008</td>
<td>缺少accessToken参数</td>
</tr>
<tr>
<td>4009</td>
<td>需要get请求</td>
</tr>
<tr>
<td>4010</td>
<td>需要post请求</td>
</tr>
<tr>
<td>4011</td>
<td>需要httpss请求</td>
</tr>
<tr>
<td>4012</td>
<td>Post数据包为空</td>
</tr>
<tr>
<td>4013</td>
<td>Api无权限</td>
</tr>
<tr>
<td>4014</td>
<td>调用来源ip不在ip白名单</td>
</tr>
<tr>
<td>4015</td>
<td>不合法的callback url</td>
</tr>
<tr>
<td>4016</td>
<td>企业未对该应用授权</td>
</tr>
<tr>
<td>4500</td>
<td>用户uid不存在或者错误</td>
</tr>
<tr>
<td>4501</td>
<td>缺少uid参数</td>
</tr>
</tbody>
</table>

<h1>
<a id="二----开始开发" class="anchor" href="#%E4%BA%8C----%E5%BC%80%E5%A7%8B%E5%BC%80%E5%8F%91" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>二，    开始开发</h1>

<h2>
<a id="1-接入指南" class="anchor" href="#1-%E6%8E%A5%E5%85%A5%E6%8C%87%E5%8D%97" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>1， 接入指南</h2>

<h3>
<a id="概述" class="anchor" href="#%E6%A6%82%E8%BF%B0" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>概述</h3>

<blockquote>
<p>接入开放平台，开发者需要完成以下3步：</p>

<ul>
<li>1.1 提交服务器配置
由于目前开发者后台还在公测中，还未对正式开发者开放，所有需要开发者把以下信息通过以下格式，以邮件（<em><a href="mailto:luohj@shinemo.com">luohj@shinemo.com</a></em>）发送给 后台超级管理员，暂时由超级管理员负责录入,录入成功后会返回应用的<strong>appId和appSecret</strong> 。</li>
</ul>
</blockquote>

<table>
<thead>
<tr>
<th>名称</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>开发者名字</td>
<td>张三</td>
</tr>
<tr>
<td>开发者地址</td>
<td>浙江省杭州市西湖区文二西路888号我的公司</td>
</tr>
<tr>
<td>开发者联系手机号</td>
<td>18888888888</td>
</tr>
<tr>
<td>开发者身份证号</td>
<td>370686199904440000</td>
</tr>
<tr>
<td>开发者照片</td>
<td>照片形式放到附件中</td>
</tr>
<tr>
<td>开发者企业名称</td>
<td>...</td>
</tr>
<tr>
<td>开发者企业地址</td>
<td>...</td>
</tr>
<tr>
<td>开发者企业法人代表名字</td>
<td>...</td>
</tr>
<tr>
<td>开发者企业法人代表身份证号</td>
<td>...</td>
</tr>
<tr>
<td>开发者企业营业执照</td>
<td>照片形式放到附件</td>
</tr>
<tr>
<td>开发者企业类型</td>
<td>...</td>
</tr>
<tr>
<td>应用名称</td>
<td>...</td>
</tr>
<tr>
<td>应用icon</td>
<td>照片形式放到附件</td>
</tr>
<tr>
<td>应用描述</td>
<td>256字以内</td>
</tr>
<tr>
<td>服务器白名单ip（开放平台服务端只允许白名单内的ip访问，逗号分隔）</td>
<td>...</td>
</tr>
<tr>
<td>H5地址（应用如果是h5须填写h5地址）</td>
<td>...</td>
</tr>
<tr>
<td>Android_feature(应用如果是native，填写android的应用信息)</td>
<td>...</td>
</tr>
<tr>
<td>Ios_feature(应用如果是native，填写ios的应用信息)</td>
<td>...</td>
</tr>
<tr>
<td>应用的语言版本（中文 ，英文…）</td>
<td>...</td>
</tr>
<tr>
<td>应用发布到的客户端（ ，集团彩云，联通客户端，全部）</td>
<td>...</td>
</tr>
<tr>
<td>应用需要使用的接口列表（目前只有获取用户信息）</td>
<td>...</td>
</tr>
<tr>
<td>应用的可见范围（企业名称或者全部）</td>
<td>...</td>
</tr>
</tbody>
</table>

<ul>
<li>1.2   验证服务器地址有效性（暂时略过）</li>
<li>1.3   依据接口文档实现业务逻辑
调用各接口时，一般会获得正确的结果，具体结果可见对应接口的说明。返回错误时，可根据返回码来查询错误原因。
另请注意，开放平台接口只支持80接口</li>
</ul>

<h2>
<a id="2-获取接口调用凭据accesstoken" class="anchor" href="#2-%E8%8E%B7%E5%8F%96%E6%8E%A5%E5%8F%A3%E8%B0%83%E7%94%A8%E5%87%AD%E6%8D%AEaccesstoken" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2， 获取接口调用凭据（accessToken）</h2>

<blockquote>
<p>accessToken是开放平台的全局唯一票据，开放平台各接口时都需使用accessToken。开发者需要进行妥善保存。accessToken的存储至少要保留512个字符空间。accessToken的有效期目前为2个小时，需定时刷新，重复获取将导致上次获取的accessToken失效。</p>
</blockquote>

<ul>
<li>2.1 为了保密appSecrect，第三方需要一个accessToken获取和刷新的中控服务器。而其他业务逻辑服务器所使用的accessToken均来自于该中控服务器，不应该各自去刷新，否则会造成accessToken覆盖而影响业务；</li>
<li>2.2 目前accessToken的有效期通过返回的expireIn来传达，目前是7200秒之内的值。中控服务器需要根据这个有效时间提前去刷新新accessToken。在刷新过程中，中控服务器对外输出的依然是老accessToken，此时公众平台后台会保证在刷新短时间内，新老accessToken都可用，这保证了第三方业务的平滑过渡；</li>
<li>2.3 accessToken的有效时间可能会在未来有调整，所以中控服务器不仅需要内部定时主动刷新，还需要提供被动刷新accessToken的接口，这样便于业务服务器在API调用获知accessToken已超时的情况下，可以触发accessToken的刷新流程。
使用AppID和AppSecret调用本接口来获取accessToken。AppID和AppSecret可在邮件回复中获得（需要提供上述的开发者信息邮件给超级管理员，且帐号没有异常状态）</li>
</ul>

<p><strong>接口调用请求说明</strong></p>

<ul>
<li>https请求方式: GET</li>
</ul>

<p><code>https://api.open.jituancaiyun.com/openapi/token/get?appId=APPID&amp;appSecret=APPSECRET</code></p>

<ul>
<li>参数说明：</li>
</ul>

<table>
<thead>
<tr>
<th>参数</th>
<th>是否必须</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>appId</td>
<td>是</td>
<td>应用注册成功后返回</td>
</tr>
<tr>
<td>appSecret</td>
<td>是</td>
<td>应用注册成功后返回</td>
</tr>
</tbody>
</table>

<ul>
<li>返回说明：
正常情况下开放平台会返回下述JSON数据包给用户</li>
</ul>

<pre><code>
{"status":0,"data":{"accessToken":"MDAwMjM0M0RBNjIwMURENDAxOTJDRkE0MkVGMDlERjQ5MjVFODAzQTlFMThERDBCMzNBNzFEMjBFMkRCNjExRDgxQjM3RkU0QzM1NkMwQzM5NkNCODUyN0JFQTE1OUE5OUUzMg==","expiresIn":7200}}

</code></pre>

<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>status</td>
<td>开放平台处理状态</td>
</tr>
<tr>
<td>data</td>
<td>处理成功后会把数据字段放到这里</td>
</tr>
<tr>
<td>accessToken</td>
<td>访问凭据</td>
</tr>
<tr>
<td>expiresIn</td>
<td>凭证有效时间，单位：秒</td>
</tr>
</tbody>
</table>

<p>错误时开放平台会返回错误码等信息，JSON数据包示例如下（该示例为AppID无效错误）</p>

<pre><code>{"status":4007,"message":"获取accessToken时appId或者appSecret错误"}

</code></pre>

<h2>
<a id="3-测试号申请" class="anchor" href="#3-%E6%B5%8B%E8%AF%95%E5%8F%B7%E7%94%B3%E8%AF%B7" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>3， 测试号申请</h2>

<blockquote>
<p>开放平台为每个开发者账号最多提供10个测试应用账号，测试应用不需要企业认证，默认拥有所有接口权限，访问频率控制与正式应用相同。</p>
</blockquote>

<ul>
<li>3.1 测试号申请暂时通过跟正式应用申请相同方式，邮件给指定人申请，后续会陆续开放后台自助申请。</li>
<li>3.2 测试号申请完毕后，需要加入该测试号的测试人，加入方式同上。
## 4， 接口在线调试
## 5， 常见问题</li>
<li>5.1 accessToken失效：请检查accessToken全局唯一性，重复获取将导致上一次获取的accessToken失效；</li>
</ul>

<h1>
<a id="三----服务端开发文档" class="anchor" href="#%E4%B8%89----%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>三，    服务端开发文档</h1>

<h2>
<a id="1-获取用户信息登录token机制" class="anchor" href="#1-%E8%8E%B7%E5%8F%96%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E7%99%BB%E5%BD%95token%E6%9C%BA%E5%88%B6" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>1， 获取用户信息（登录token机制）</h2>

<ul>
<li>https请求方式: GET</li>
</ul>

<p><code>https://api.open.jituancaiyun.com/openapi/auth/getUserInfoByToken?token=TOKEN&amp;accessToken=ACCESSTOKEN</code></p>

<ul>
<li>参数说明：</li>
</ul>

<table>
<thead>
<tr>
<th>参数</th>
<th>是否必须</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>token</td>
<td>是</td>
<td>客户端拼接上的token</td>
</tr>
<tr>
<td>accessToken</td>
<td>是</td>
<td>接口访问凭据</td>
</tr>
</tbody>
</table>

<ul>
<li>返回说明：
正常情况下开放平台会返回下述JSON数据包给用户</li>
</ul>

<pre><code>
{"status":0,"data":{"uid":"REAM123","name":"张三", "orgList":[{"orgName":"杭州讯盟科技",orgId:1}, {"orgName":"芒果医生",orgId:2}, {"orgName":"阿里巴巴",orgId:3}...]}}

</code></pre>

<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>status</td>
<td>开放平台处理状态</td>
</tr>
<tr>
<td>data</td>
<td>处理成功后会把数据字段放到这里</td>
</tr>
<tr>
<td>uid</td>
<td>用户在开放平台的id（经过加密），后续获取用户信息需要通过此uid</td>
</tr>
<tr>
<td>orgList</td>
<td>用户所在机构列表</td>
</tr>
<tr>
<td>orgName</td>
<td>用户所在机构名字</td>
</tr>
<tr>
<td>orgId</td>
<td>用户所在机构id</td>
</tr>
</tbody>
</table>

<p>错误时开放平台会返回错误码等信息，JSON数据包示例如下（该示例为accessToken超时）</p>

<pre><code>{"status":4003,"message":"accessToken超时，请重新获取"}

</code></pre>

<h2>
<a id="2-获取用户信息用户uid机制" class="anchor" href="#2-%E8%8E%B7%E5%8F%96%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E7%94%A8%E6%88%B7uid%E6%9C%BA%E5%88%B6" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2， 获取用户信息（用户uid机制）</h2>

<ul>
<li>https请求方式: GET</li>
</ul>

<p><code>https://api.open.jituancaiyun.com/openapi/user/getUserInfoById?uid=UID&amp;accessToken=ACCESSTOKEN</code></p>

<ul>
<li>参数说明：</li>
</ul>

<table>
<thead>
<tr>
<th>参数</th>
<th>是否必须</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>uid</td>
<td>是</td>
<td>用户uid</td>
</tr>
<tr>
<td>accessToken</td>
<td>是</td>
<td>接口访问凭据</td>
</tr>
</tbody>
</table>

<ul>
<li>返回说明：
正常情况下开放平台会返回下述JSON数据包给用户</li>
</ul>

<pre><code>
{"status":0,"data":{"uid":"REAM123","name":"张三", "orgList":[{"orgName":"杭州讯盟科技",orgId:1}, {"orgName":"芒果医生",orgId:2}, {"orgName":"阿里巴巴",orgId:3}...]}}

</code></pre>

<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>status</td>
<td>开放平台处理状态</td>
</tr>
<tr>
<td>data</td>
<td>处理成功后会把数据字段放到这里</td>
</tr>
<tr>
<td>uid</td>
<td>用户在开放平台的id（经过加密），后续获取用户信息需要通过此uid</td>
</tr>
<tr>
<td>orgList</td>
<td>用户所在机构列表</td>
</tr>
<tr>
<td>orgName</td>
<td>用户所在机构名字</td>
</tr>
<tr>
<td>orgId</td>
<td>用户所在机构id</td>
</tr>
</tbody>
</table>

<p>错误时开放平台会返回错误码等信息，JSON数据包示例如下（该示例为accessToken超时）</p>

<pre><code>{"status":4003,"message":"accessToken超时，请重新获取"}

</code></pre>

<h2>
<a id="3-获取部门列表" class="anchor" href="#3-%E8%8E%B7%E5%8F%96%E9%83%A8%E9%97%A8%E5%88%97%E8%A1%A8" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>3， 获取部门列表</h2>

<ul>
<li>https请求方式: GET</li>
</ul>

<p><code>https://api.open.jituancaiyun.com/openapi/department/list?accessToken=ACCESSTOKEN</code></p>

<ul>
<li>参数说明：</li>
</ul>

<table>
<thead>
<tr>
<th>参数</th>
<th>是否必须</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>accessToken</td>
<td>是</td>
<td>接口访问凭据</td>
</tr>
</tbody>
</table>

<ul>
<li>返回说明：
正常情况下开放平台会返回下述JSON数据包给用户</li>
</ul>

<pre><code>
{"status":0,"data":{"departments":[{"id":1,name:"开发部","parentid":1}, {"id":2,name:"测试部","parentid":1}...]}}

</code></pre>

<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>status</td>
<td>开放平台处理状态</td>
</tr>
<tr>
<td>data</td>
<td>处理成功后会把数据字段放到这里</td>
</tr>
<tr>
<td>departments</td>
<td>部门列表数据</td>
</tr>
<tr>
<td>id</td>
<td>部门id</td>
</tr>
<tr>
<td>name</td>
<td>部门名称</td>
</tr>
<tr>
<td>parentid</td>
<td>父部门id</td>
</tr>
</tbody>
</table>

<p>错误时开放平台会返回错误码等信息，JSON数据包示例如下（该示例为accessToken超时）</p>

<pre><code>{"status":4003,"message":"accessToken超时，请重新获取"}

</code></pre>

<h2>
<a id="4-获取部门成员列表" class="anchor" href="#4-%E8%8E%B7%E5%8F%96%E9%83%A8%E9%97%A8%E6%88%90%E5%91%98%E5%88%97%E8%A1%A8" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>4， 获取部门成员列表</h2>

<ul>
<li>https请求方式: GET</li>
</ul>

<p><code>https://api.open.jituancaiyun.com/openapi/user/list?accessToken=ACCESSTOKEN&amp;deptId=DEPTID&amp;offset=0&amp;size=100</code></p>

<ul>
<li>参数说明：</li>
</ul>

<table>
<thead>
<tr>
<th>参数</th>
<th>是否必须</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>accessToken</td>
<td>是</td>
<td>接口访问凭据</td>
</tr>
<tr>
<td>deptId</td>
<td>是</td>
<td>部门id</td>
</tr>
<tr>
<td>offset</td>
<td>是</td>
<td>页偏移量</td>
</tr>
<tr>
<td>size</td>
<td>是</td>
<td>每页的数量</td>
</tr>
<tr>
<td>order</td>
<td>否</td>
<td>排序</td>
</tr>
</tbody>
</table>

<ul>
<li>返回说明：
正常情况下开放平台会返回下述JSON数据包给用户</li>
</ul>

<pre><code>
{"status":0,"data":{"hasMore":true, "users":[{"uid":123, "name":"张三"},{"uid":124, "name":"李四"},...]}}

</code></pre>

<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>status</td>
<td>开放平台处理状态</td>
</tr>
<tr>
<td>data</td>
<td>处理成功后会把数据字段放到这里</td>
</tr>
<tr>
<td>hasMore</td>
<td>是否还有更多</td>
</tr>
<tr>
<td>uid</td>
<td>用户id</td>
</tr>
<tr>
<td>name</td>
<td>用户名字</td>
</tr>
</tbody>
</table>

<p>错误时开放平台会返回错误码等信息，JSON数据包示例如下（该示例为accessToken超时）</p>

<pre><code>{"status":4003,"message":"accessToken超时，请重新获取"}

</code></pre>

<h2>
<a id="5-获取成员详情" class="anchor" href="#5-%E8%8E%B7%E5%8F%96%E6%88%90%E5%91%98%E8%AF%A6%E6%83%85" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>5， 获取成员详情</h2>

<ul>
<li>https请求方式: GET</li>
</ul>

<p><code>https://api.open.jituancaiyun.com/openapi/user/detail?accessToken=ACCESSTOKEN&amp;uid=UID</code></p>

<ul>
<li>参数说明：</li>
</ul>

<table>
<thead>
<tr>
<th>参数</th>
<th>是否必须</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>accessToken</td>
<td>是</td>
<td>接口访问凭据</td>
</tr>
<tr>
<td>uid</td>
<td>是</td>
<td>用户id</td>
</tr>
</tbody>
</table>

<ul>
<li>返回说明：
正常情况下开放平台会返回下述JSON数据包给用户</li>
</ul>

<pre><code>
{"status":0,"data":{"avatar":"https://", "name":"张三", "deptId":1}}

</code></pre>

<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>status</td>
<td>开放平台处理状态</td>
</tr>
<tr>
<td>data</td>
<td>处理成功后会把数据字段放到这里</td>
</tr>
<tr>
<td>avatar</td>
<td>头像</td>
</tr>
<tr>
<td>deptId</td>
<td>所属部门id</td>
</tr>
<tr>
<td>name</td>
<td>用户名字</td>
</tr>
</tbody>
</table>

<p>错误时开放平台会返回错误码等信息，JSON数据包示例如下（该示例为accessToken超时）</p>

<pre><code>{"status":4003,"message":"accessToken超时，请重新获取"}

</code></pre>

<h2>
<a id="6-发送聊天消息" class="anchor" href="#6-%E5%8F%91%E9%80%81%E8%81%8A%E5%A4%A9%E6%B6%88%E6%81%AF" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>6， 发送聊天消息</h2>

<ul>
<li>https请求方式: POST</li>
</ul>

<p><code>https://api.open.jituancaiyun.com/openapi/message/chat/push</code></p>

<ul>
<li>参数说明：</li>
</ul>

<table>
<thead>
<tr>
<th>参数</th>
<th>是否必须</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>accessToken</td>
<td>是</td>
<td>接口访问凭据</td>
</tr>
<tr>
<td>uid</td>
<td>是</td>
<td>发送者id</td>
</tr>
<tr>
<td>targetId</td>
<td>是</td>
<td>接受者id</td>
</tr>
<tr>
<td>msgType</td>
<td>是</td>
<td>消息类型</td>
</tr>
</tbody>
</table>

<p>** msgType(消息类型)及数据格式 **</p>

<ul>
<li>text消息</li>
<li>参数说明</li>
</ul>

<table>
<thead>
<tr>
<th>参数</th>
<th>是否必须</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>msgType</td>
<td>是</td>
<td>消息类型，此时固定为：text</td>
</tr>
<tr>
<td>content</td>
<td>是</td>
<td>消息内容</td>
</tr>
</tbody>
</table>

<pre><code>

{
    "msgType": "text",
    "text": {
        "content": "张三的请假申请"
    }
  }


</code></pre>

<ul>
<li>image消息</li>
<li>参数说明</li>
</ul>

<table>
<thead>
<tr>
<th>参数</th>
<th>是否必须</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>msgType</td>
<td>是</td>
<td>消息类型，此时固定为：image</td>
</tr>
<tr>
<td>mediaId</td>
<td>是</td>
<td>图片媒体文件id，可以调用上传媒体文件接口获取</td>
</tr>
</tbody>
</table>

<pre><code>

{
    "msgType": "image",
    "image": {
        "mediaId": "MEDIA_ID"
    }
}

</code></pre>

<ul>
<li>voice消息</li>
<li>参数说明</li>
</ul>

<table>
<thead>
<tr>
<th>参数</th>
<th>是否必须</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>msgType</td>
<td>是</td>
<td>消息类型，此时固定为：image</td>
</tr>
<tr>
<td>mediaId</td>
<td>是</td>
<td>图片媒体文件id，可以调用上传媒体文件接口获取</td>
</tr>
</tbody>
</table>

<pre><code>{
    "msgType": "voice",
    "voice": {
       "mediaId": "MEDIA_ID",
       "duration": "10"
    }
}

</code></pre>

<ul>
<li>link消息</li>
<li>参数说明</li>
</ul>

<table>
<thead>
<tr>
<th>参数</th>
<th>是否必须</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>msgType</td>
<td>是</td>
<td>消息类型，此时固定为：link</td>
</tr>
<tr>
<td>messageUrl</td>
<td>是</td>
<td>消息点击链接地址</td>
</tr>
<tr>
<td>mediaId</td>
<td>是</td>
<td>图片媒体文件id，可以调用上传媒体文件接口获取</td>
</tr>
<tr>
<td>title</td>
<td>是</td>
<td>消息标题</td>
</tr>
<tr>
<td>text</td>
<td>是</td>
<td>消息描述</td>
</tr>
</tbody>
</table>

<pre><code>
{
    "msgType": "link",
    "link": {
        "messageUrl": "https://www.baidu.com",
        "mediaId":"@lALOACZwe2Rk",
        "title": "测试",
        "text": "测试"
    }
}

</code></pre>

<ul>
<li>返回说明：
正常情况下开放平台会返回下述JSON数据包给用户</li>
</ul>

<pre><code>
{"status":0,"success":true}

</code></pre>

<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>status</td>
<td>开放平台处理状态</td>
</tr>
</tbody>
</table>

<p>错误时开放平台会返回错误码等信息，JSON数据包示例如下（该示例为accessToken超时）</p>

<pre><code>{"status":4003,"message":"accessToken超时，请重新获取"}

</code></pre>

<h2>
<a id="7-上传媒体文件" class="anchor" href="#7-%E4%B8%8A%E4%BC%A0%E5%AA%92%E4%BD%93%E6%96%87%E4%BB%B6" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>7， 上传媒体文件</h2>

<ul>
<li>https请求方式: POST</li>
</ul>

<p><code>https://api.open.jituancaiyun.com/openapi/media/upload</code></p>

<ul>
<li>参数说明：</li>
</ul>

<table>
<thead>
<tr>
<th>参数</th>
<th>是否必须</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>accessToken</td>
<td>是</td>
<td>接口访问凭据</td>
</tr>
<tr>
<td>type</td>
<td>是</td>
<td>用户id</td>
</tr>
<tr>
<td>media</td>
<td>是</td>
<td>form-data中媒体文件标识，有filename、filelength、content-type等信息</td>
</tr>
</tbody>
</table>

<p>** 上传的媒体文件限制 **</p>

<p><code>图片（image）:1MB，支持JPG格式</code></p>

<p><code>语音（voice）：2MB，播放长度不超过60s，AMR格式</code></p>

<ul>
<li>返回说明：
正常情况下开放平台会返回下述JSON数据包给用户</li>
</ul>

<pre><code>
{"status":0,"data":{"type":"image", "mediaId":"dsa8d87y7c8d8c"}}

</code></pre>

<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>status</td>
<td>开放平台处理状态</td>
</tr>
<tr>
<td>data</td>
<td>处理成功后会把数据字段放到这里</td>
</tr>
<tr>
<td>type</td>
<td>媒体文件类型，分别有图片（image）、语音（voice）等</td>
</tr>
<tr>
<td>mediaId</td>
<td>媒体文件上传后获取的唯一标识</td>
</tr>
</tbody>
</table>

<p>错误时开放平台会返回错误码等信息，JSON数据包示例如下（该示例为accessToken超时）</p>

<pre><code>{"status":4003,"message":"accessToken超时，请重新获取"}

</code></pre>

<h2>
<a id="8-获取媒体文件" class="anchor" href="#8-%E8%8E%B7%E5%8F%96%E5%AA%92%E4%BD%93%E6%96%87%E4%BB%B6" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>8， 获取媒体文件</h2>

<ul>
<li>https请求方式: GET</li>
</ul>

<p><code>https://api.open.jituancaiyun.com/openapi/media/get?accessToken=ACCESSTOKEN&amp;mediaId=MEDIAID</code></p>

<ul>
<li>参数说明：</li>
</ul>

<table>
<thead>
<tr>
<th>参数</th>
<th>是否必须</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>accessToken</td>
<td>是</td>
<td>接口访问凭据</td>
</tr>
<tr>
<td>mediaId</td>
<td>是</td>
<td>媒体文件的唯一标示</td>
</tr>
</tbody>
</table>

<ul>
<li>返回说明：
和普通的https下载相同，请根据https头做相应的处理</li>
</ul>

<h1>
<a id="四----开发demo" class="anchor" href="#%E5%9B%9B----%E5%BC%80%E5%8F%91demo" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>四，    开发demo</h1>

<p><a href="http://https://github.com/jituancaiyun/openapi-demo">Java Common Github DEMO</a></p>

<p><a href="http://https://github.com/jituancaiyun/openapi-demo">Java SDK Github DEMO</a></p>
      </section>
      <footer>
        <p><small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		
  </body>
</html>
